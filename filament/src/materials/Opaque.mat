material {
    name : Opaque,
    specularAntiAliasing : true,
    doubleSided: true,
    postLightingBlending : transparent,
    parameters : [
        //////////////////////////////////////////////////////////////////////////////////////////////////
        // Attributes that may have a texture assigned to them. A single control to set their value when
        // no texture is selected is optional but always named as the material, if present.
        //////////////////////////////////////////////////////////////////////////////////////////////////
        {
            type : int,
            name : useBaseColorTexture
        },
        {
            type : sampler2d,
            name : baseColorTexture
        },
        {
            type : float4,
            name : baseColor
        },

        {
            type : float3,
            name : tintColor,
        },

        {
            type : int,
            name : useNormalTexture
        },
        {
            type : sampler2d,
            name : normalTexture
        },

        {
            type : int,
            name : useRoughnessTexture
        },
        {
            type : sampler2d,
            name : roughnessTexture
        },
        {
            type : float,
            name : roughness
        },

        {
            type : int,
            name : useClearCoatNormalTexture
        },
        {
            type : sampler2d,
            name : clearCoatNormalTexture
        },

        {
            type : int,
            name : useClearCoatRoughnessTexture
        },
        {
            type : sampler2d,
            name : clearCoatRoughnessTexture
        },
        {
            type : float,
            name : clearCoatRoughness
        },

        {
            type : int,
            name : useMetallicTexture
        },
        {
            type : sampler2d,
            name : metallicTexture
        },
        {
            type : float,
            name : metallic
        },

        {
            type : int,
            name : useOcclusionTexture
        },
        {
            type : sampler2d,
            name : occlusionTexture
        },
        {
            type : float,
            name : occlusion
        },
        {
            type : float,
            name : occlusionIntensity
        },

        {
            type : int,
            name : useSheenRoughnessTexture
        },
        {
            type : sampler2d,
            name : sheenRoughnessTexture
        },
        {
            type : float,
            name : sheenRoughness
        },
        {
            type : float2,
            name : emissive
        },
        //////////////////////////////////////////////////////////////////////////////////////////////////
        // Texture lookup scaling that transforms world coordinates to triplanar coordinates
        //////////////////////////////////////////////////////////////////////////////////////////////////

        { // .r: baseColor, .g: normal|roughness|metallic, .b: clearCoat{Normal|Roughness|value} scaler, .a: ior, transmission, thickness|microThickness texture scalers
            type : float4,
            name : textureScaler
        },
        { // this is a compatibility attribute with the GltfViewer extra tweaks
            type : float4,
            name : scalingControl
        },
        { // this is a compatibility attribute with the Filament generated materials
            type : float,
            name : normalIntensity
        },
        { // this is a compatibility attribute with the Filament generated materials
            type : float,
            name : clearCoatNormalIntensity
        },
        //////////////////////////////////////////////////////////////////////////////////////////////////
        // material attributes that are purely driven by UBO values
        //////////////////////////////////////////////////////////////////////////////////////////////////
        {
            type : float,
            name : specularIntensity
        },
        {
            type : float,
            name : clearCoat
        },
        {
            type : float,
            name : roughnessScale
        },
        {
            type : float,
            name : anisotropy
        },
        {
            type : float3,
            name : anisotropyDirection
        },
        {
            type : int,
            name : doDeriveSheenColor
        },
        {
            type : float3,
            name : sheenColor
        },
        {
            type : float,
            name : sheenIntensity
        },
        {
            type : int,
            name : useWard
        },
        {
            type : float4,
            name : ambientColor
        },
        ////////////////////////////////////////////////////////////////////////////////////////////////////
        // Our ASTC compressor lays out the coordinates as XXXY but our BC5 compressor lays them out as XY.
        // This flag indicates if data is stored as XY or XXXY (so we can sample the normal map accordingly)
        ////////////////////////////////////////////////////////////////////////////////////////////////////
        {
            type : int,
            name : useSwizzledNormalMaps
        }
    ],
    variables: [
        objectSpacePosition,
        objectSpaceNormal
    ],
    quality : high
}

vertex {
    #include "MaterialHelpersVertex.fxh"

    void materialVertex(inout MaterialVertexInputs material) {
        ProcessVertex(material);
    }
}

fragment {
    #include "MaterialHelpersShading.fxh"

    void material(inout MaterialInputs material) {
        ApplyEditorScalers(material);

        FragmentData fragmentData = GetPositionAndNormal();

        ApplyAllPrePrepare(material, fragmentData);

        prepareMaterial(material);

        ApplyAllPostPrepare(material, fragmentData);
    }
}